<!DOCTYPE html>
<html>
<body onload="onLoad()">
    <h1>welcome to the room</h1>
    <form>
        <select id="input1">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
        <select id="input2">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
        <select id="input3">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
    </form>
    <button onclick="createChar()">create</button>
    <div id="0"></div>
    <button onclick="update('0', true)">+</button><button onclick="update('0', false)">-</button>
    <div class="chars" id="1"></div>
    <button onclick="update('1', true)">+</button><button onclick="update('1', false)">-</button>
    <div class="chars" id="2"></div>
    <button onclick="update('2', true)">+</button><button onclick="update('2', false)">-</button>
    <div class="chars" id="3"></div>
    <button onclick="update('3', true)">+</button><button onclick="update('3', false)">-</button>
    <div class="chars" id="4"></div>
    <button onclick="update('4', true)">+</button><button onclick="update('4', false)">-</button>
    <div class="chars" id="5"></div>
    <button onclick="update('5', true)">+</button><button onclick="update('5', false)">-</button>
    <div class="chars" id="6"></div>
    <button onclick="update('6', true)">+</button><button onclick="update('6', false)">-</button>
    <div class="chars" id="7"></div>
    <button onclick="update('7', true)">+</button><button onclick="update('7', false)">-</button>
    <div class="chars" id="8"></div>
    <button onclick="update('8', true)">+</button><button onclick="update('8', false)">-</button>
</body>
</html>
<script>
var awaiting = false
var url = "https://script.google.com/macros/s/AKfycbx01WayjWlnC3uo5NrUUXI-Pk7k71Oe7ovdwzClJIRKjN3UsyDrv1gAfXhtmqwSaLoNXA/exec"
function onLoad() {
    awaiting = true
    fetch(url + "?path=Sheet3&action=read")
    .then(res => res.json())
    .then(data => onLoad2(data))
    fetch(url + "?path=Sheet2&action=read")
    .then(res => res.json())
    .then(data => onLoad2(data))
}
function onLoad2(dbData) {
    for(let i = 0; i < dbData.data.length; i++) {
        let div = document.createElement("test")
        div.innerHTML = dbData.data[i].Users
        document.getElementById(i).appendChild(div)
    }
    awating = false
document.getElementById(8). innerHTML = awaiting
}
function createChar() {
    if(!awaiting) {
        awaiting = true
        fetch(url + "?path=Sheet3&action=read")
        .then(res => res.json())
        .then(data => comment2(data))
    }
}
function comment2(dbData) {
    if(dbData.data.length >= 9) {
        console.log("limit reached")
    } else {
        var name = document.getElementById("input1").value + document.getElementById("input2").value + document.getElementById("input3").value
        fetch(url + "?path=Sheet3&action=write&Users=" + name)
        fetch(url + "?path=Sheet2&action=write&Users=1")
        let div1 = document.createElement("test")
        div1.innerHTML = name
        document.getElementById(dbData.data.length).appendChild(div1)
        let div2 = document.createElement("test")
        div2.innerHTML = 1
        document.getElementById(dbData.data.length).appendChild(div2)
    }
    awaiting = false
}
function comment3(dbData) { // usesless?
    let div = document.createElement("test")
    div.innerHTML = dbData.data[dbData.data.length - 1].Users
    document.getElementById(dbData.data.length).appendChild(div)
}
function update(id, positive) {
    if(!awaiting) {
        awaiting = true
        fetch(url + "?path=Sheet2&action=read")
        .then(res => res.json())
        .then(data => update2(data, id, positive))
    }
}
function update2(dbData, id, positive) {
    var newValue = dbData.data[id].Users
    positive ? newValue++ : newValue--
    id++
    id++
    if(newValue > 0) {
        fetch(url + "?path=Sheet2&action=update&Users=" + newValue + "&number=" + id)
        reset()
        fetch(url + "?path=Sheet2&action=read")
        .then(res => res.json())
        .then(data => onLoad2(data))
        fetch(url + "?path=Sheet3&action=read")
        .then(res => res.json())
        .then(data => onLoad2(data))
    } else {
        fetch(url + "?path=Sheet2&action=remove&number=" + id)
        fetch(url + "?path=Sheet3&action=remove&number=" + id)
        document.getElementById(id - 2).innerHTML = ""
    }
    awating = false
}
function reset() {
    for(let i = 0; i < 9; i++) {
        document.getElementById(i).innerHTML = ""
    }
}
</script>
<style>
    .chars{
    }
</style>