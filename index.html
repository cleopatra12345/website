<!DOCTYPE html>
<html>
<body onload="onLoad()">
    <h1>welcome to the room</h1>
    <form>
        <select id="input1">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
        <select id="input2">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
        <select id="input3">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="G">G</option>
            <option value="H">H</option>
            <option value="I">I</option>
            <option value="J">J</option>
            <option value="K">K</option>
            <option value="L">L</option>
            <option value="M">M</option>
            <option value="N">N</option>
            <option value="O">O</option>
            <option value="P">P</option>
            <option value="Q">Q</option>
            <option value="R">R</option>
            <option value="S">S</option>
            <option value="T">T</option>
            <option value="U">U</option>
            <option value="V">V</option>
            <option value="W">W</option>
            <option value="X">X</option>
            <option value="Y">Y</option>
            <option value="Z">Z</option>
        </select>
    </form>
    <button onclick="createChar()">create</button>
    <div id="1"></div>
    <div id="2"></div>
    <div id="3"></div>
    <div id="4"></div>
    <div id="5"></div>
    <div id="6"></div>
    <div id="7"></div>
    <div id="8"></div>
    <div id="9"></div>
</body>
</html>
<script>
var url = "https://script.google.com/macros/s/AKfycbxz8NdaAxt2Ps5qNdtbN0C-4LEgaCOfdWBc2XCjxoa54MlL1dae5yb03F4vU1X3D0BogQ/exec"

function onLoad(output) {
    fetch(url + "?path=Sheet3&action=read")
    .then(res => res.json())
    .then(data => onLoad2(data))
    fetch(url + "?path=Sheet2&action=read")
    .then(res => res.json())
    .then(data => onLoad2(data))
}
function onLoad2(dbData) {
    for(let i = 0; i < dbData.data.length; i++) {
        let div = document.createElement(document.getElementById(i))
        div.innerHTML = dbData.data[i].Users
        mainContainer.appendChild(div)
    }
}
function createChar(output) {
    fetch(url + "?path=Sheet3&action=read")
    .then(res => res.json())
    .then(data => comment2(data, output))
}
function comment2(dbData, output) {
    if(dbData.data.length >= 9) {
        console.log("limit reached")
    } else {
        fetch(url + "?path=Sheet3&action=write&Users=" + document.getElementById("input1").value + document.getElementById("input2").value + document.getElementById("input3").value)
        fetch(url + "?path=Sheet2&action=write&Users=1")
        fetch(url + "?path=Sheet3&action=read")
        .then(res => res.json())
        .then(data => comment3(dbData, output))
        fetch(url + "?path=Sheet2&action=read")
        .then(res => res.json())
        .then(data => comment3(dbData, output))
    }
}
function comment3(dbData, outputContainer) {
    let div = document.createElement(outputContainer)
    div.innerHTML = dbData.data[dbData.data.length - 1].Users
    mainContainer.appendChild(div)
}
</script>
